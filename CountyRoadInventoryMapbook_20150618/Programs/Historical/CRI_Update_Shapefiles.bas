Attribute VB_Name = "Export_County_Shapefiles"
Dim coname(138)
Dim conbr(138)
Dim countyname As String
Dim countynbr As String
Sub CRIToCounty()
  'get the document
  Dim pDoc As IMxDocument
  Set pDoc = ThisDocument
  
  'setup the layer and feature selection
  Dim pFeatureSelection As IFeatureSelection
  Dim pLayer As ILayer
   
  'setup the filter
  Dim pQueryFilter As IQueryFilter
  Set pQueryFilter = New QueryFilter

'North Counties
coname(0) = "Anderson"
coname(1) = "Archer"
coname(2) = "Armstrong"
coname(3) = "Bailey"
coname(4) = "Bastrop"
coname(5) = "Baylor"
coname(6) = "Bell"
coname(7) = "Blanco"
coname(8) = "Borden"
coname(9) = "Bosque"
coname(10) = "Bowie"
coname(11) = "Briscoe"
coname(12) = "Brown"
coname(13) = "Burnet"
coname(14) = "Caldwell"
coname(15) = "Callahan"
coname(16) = "Camp"
coname(17) = "Carson"
coname(18) = "Cass"
coname(19) = "Castro"
coname(20) = "Cherokee"
coname(21) = "Childress"
coname(22) = "Clay"
coname(23) = "Cochran"
coname(24) = "Coleman"
coname(25) = "Collin"
coname(26) = "Collingsworth"
coname(27) = "Comanche"
coname(28) = "Cooke"
coname(29) = "Coryell"
coname(30) = "Cottle"
coname(31) = "Crosby"
coname(32) = "Dallam"
coname(33) = "Dallas"
coname(34) = "Dawson"
coname(35) = "Deaf Smith"
coname(36) = "Delta"
coname(37) = "Denton"
coname(38) = "Dickens"
coname(39) = "Donley"
coname(40) = "Eastland"
coname(41) = "Ellis"
coname(42) = "Erath"
coname(43) = "Falls"
coname(44) = "Fannin"
coname(45) = "Fisher"
coname(46) = "Floyd"
coname(47) = "Foard"
coname(48) = "Franklin"
coname(49) = "Gaines"
coname(50) = "Garza"
coname(51) = "Gillespie"
coname(52) = "Gray"
coname(53) = "Grayson"
coname(54) = "Gregg"
coname(55) = "Hale"
coname(56) = "Hall"
coname(57) = "Hamilton"
coname(58) = "Hansford"
coname(59) = "Hardeman"
coname(60) = "Harrison"
coname(61) = "Hartley"
coname(62) = "Haskell"
coname(63) = "Hays"
coname(64) = "Hemphill"
coname(65) = "Henderson"
coname(66) = "Hill"
coname(67) = "Hockley"
coname(68) = "Hood"
coname(69) = "Hopkins"
coname(70) = "Howard"
coname(71) = "Hunt"
coname(72) = "Hutchinson"
coname(73) = "Jack"
coname(74) = "Johnson"
coname(75) = "Jones"
coname(76) = "Kaufman"
coname(77) = "Kent"
coname(78) = "King"
coname(79) = "Knox"
coname(80) = "Lamar"
coname(81) = "Lamb"
coname(82) = "Lampasas"
coname(83) = "Lee"
coname(84) = "Limestone"
coname(85) = "Lipscomb"
coname(86) = "Llano"
coname(87) = "Lubbock"
coname(88) = "Lynn"
coname(89) = "Marion"
coname(90) = "Mason"
coname(91) = "McCulloch"
coname(92) = "McLennan"
coname(93) = "Mills"
coname(94) = "Mitchell"
coname(95) = "Montague"
coname(96) = "Moore"
coname(97) = "Morris"
coname(98) = "Motley"
coname(99) = "Navarro"
coname(100) = "Nolan"
coname(101) = "Ochiltree"
coname(102) = "Oldham"
coname(103) = "Palo Pinto"
coname(104) = "Panola"
coname(105) = "Parker"
coname(106) = "Parmer"
coname(107) = "Potter"
coname(108) = "Rains"
coname(109) = "Randall"
coname(110) = "Red River"
coname(111) = "Roberts"
coname(112) = "Rockwall"
coname(113) = "Rusk"
coname(114) = "San Saba"
coname(115) = "Scurry"
coname(116) = "Shackelford"
coname(117) = "Sherman"
coname(118) = "Smith"
coname(119) = "Somervell"
coname(120) = "Stephens"
coname(121) = "Stonewall"
coname(122) = "Swisher"
coname(123) = "Tarrant"
coname(124) = "Taylor"
coname(125) = "Terry"
coname(126) = "Throckmorton"
coname(127) = "Titus"
coname(128) = "Travis"
coname(129) = "Upshur"
coname(130) = "Van Zandt"
coname(131) = "Wheeler"
coname(132) = "Wichita"
coname(133) = "Wilbarger"
coname(134) = "Williamson"
coname(135) = "Wise"
coname(136) = "Wood"
coname(137) = "Yoakum"
coname(138) = "Young"

'North County Numbers
conbr(0) = "001"
conbr(1) = "005"
conbr(2) = "006"
conbr(3) = "009"
conbr(4) = "011"
conbr(5) = "012"
conbr(6) = "014"
conbr(7) = "016"
conbr(8) = "017"
conbr(9) = "018"
conbr(10) = "019"
conbr(11) = "023"
conbr(12) = "025"
conbr(13) = "027"
conbr(14) = "028"
conbr(15) = "030"
conbr(16) = "032"
conbr(17) = "033"
conbr(18) = "034"
conbr(19) = "035"
conbr(20) = "037"
conbr(21) = "038"
conbr(22) = "039"
conbr(23) = "040"
conbr(24) = "042"
conbr(25) = "043"
conbr(26) = "044"
conbr(27) = "047"
conbr(28) = "049"
conbr(29) = "050"
conbr(30) = "051"
conbr(31) = "054"
conbr(32) = "056"
conbr(33) = "057"
conbr(34) = "058"
conbr(35) = "059"
conbr(36) = "060"
conbr(37) = "061"
conbr(38) = "063"
conbr(39) = "065"
conbr(40) = "068"
conbr(41) = "071"
conbr(42) = "073"
conbr(43) = "074"
conbr(44) = "075"
conbr(45) = "077"
conbr(46) = "078"
conbr(47) = "079"
conbr(48) = "081"
conbr(49) = "084"
conbr(50) = "086"
conbr(51) = "087"
conbr(52) = "091"
conbr(53) = "092"
conbr(54) = "093"
conbr(55) = "096"
conbr(56) = "097"
conbr(57) = "098"
conbr(58) = "099"
conbr(59) = "100"
conbr(60) = "103"
conbr(61) = "104"
conbr(62) = "105"
conbr(63) = "106"
conbr(64) = "107"
conbr(65) = "108"
conbr(66) = "110"
conbr(67) = "111"
conbr(68) = "112"
conbr(69) = "113"
conbr(70) = "115"
conbr(71) = "117"
conbr(72) = "118"
conbr(73) = "120"
conbr(74) = "127"
conbr(75) = "128"
conbr(76) = "130"
conbr(77) = "132"
conbr(78) = "135"
conbr(79) = "138"
conbr(80) = "139"
conbr(81) = "140"
conbr(82) = "141"
conbr(83) = "144"
conbr(84) = "147"
conbr(85) = "148"
conbr(86) = "150"
conbr(87) = "152"
conbr(88) = "153"
conbr(89) = "155"
conbr(90) = "157"
conbr(91) = "160"
conbr(92) = "161"
conbr(93) = "167"
conbr(94) = "168"
conbr(95) = "169"
conbr(96) = "171"
conbr(97) = "172"
conbr(98) = "173"
conbr(99) = "175"
conbr(100) = "177"
conbr(101) = "179"
conbr(102) = "180"
conbr(103) = "182"
conbr(104) = "183"
conbr(105) = "184"
conbr(106) = "185"
conbr(107) = "188"
conbr(108) = "190"
conbr(109) = "191"
conbr(110) = "194"
conbr(111) = "197"
conbr(112) = "199"
conbr(113) = "201"
conbr(114) = "206"
conbr(115) = "208"
conbr(116) = "209"
conbr(117) = "211"
conbr(118) = "212"
conbr(119) = "213"
conbr(120) = "215"
conbr(121) = "217"
conbr(122) = "219"
conbr(123) = "220"
conbr(124) = "221"
conbr(125) = "223"
conbr(126) = "224"
conbr(127) = "225"
conbr(128) = "227"
conbr(129) = "230"
conbr(130) = "234"
conbr(131) = "242"
conbr(132) = "243"
conbr(133) = "244"
conbr(134) = "246"
conbr(135) = "249"
conbr(136) = "250"
conbr(137) = "251"
conbr(138) = "252"

  
'South Counties
''coname(0) = "Andrews"
''coname(1) = "Angelina"
''coname(2) = "Aransas"
''coname(3) = "Atascosa"
''coname(4) = "Austin"
''coname(5) = "Bandera"
''coname(6) = "Bee"
''coname(7) = "Bexar"
''coname(8) = "Brazoria"
''coname(9) = "Brazos"
''coname(10) = "Brewster"
''coname(11) = "Brooks"
''coname(12) = "Burleson"
''coname(13) = "Calhoun"
''coname(14) = "Cameron"
''coname(15) = "Chambers"
''coname(16) = "Coke"
''coname(17) = "Colorado"
''coname(18) = "Comal"
''coname(19) = "Concho"
''coname(20) = "Crane"
''coname(21) = "Crockett"
''coname(22) = "Culberson"
''coname(23) = "De_Witt"
''coname(24) = "Dimmit"
''coname(25) = "Duval"
''coname(26) = "Ector"
''coname(27) = "Edwards"
''coname(28) = "El Paso"
''coname(29) = "Fayette"
''coname(30) = "Fort_Bend"
''coname(31) = "Freestone"
''coname(32) = "Frio"
''coname(33) = "Galveston"
''coname(34) = "Glasscock"
''coname(35) = "Goliad"
''coname(36) = "Gonzales"
''coname(37) = "Grimes"
''coname(38) = "Guadalupe"
''coname(39) = "Hardin"
''coname(40) = "Harris"
''coname(41) = "Hidalgo"
''coname(42) = "Houston"
''coname(43) = "Hudspeth"
''coname(44) = "Irion"
''coname(45) = "Jackson"
''coname(46) = "Jasper"
''coname(47) = "Jeff_Davis"
''coname(48) = "Jefferson"
''coname(49) = "Jim_Hogg"
''coname(50) = "Jim_Wells"
''coname(51) = "Karnes"
''coname(52) = "Kendall"
''coname(53) = "Kenedy"
''coname(54) = "Kerr"
''coname(55) = "Kimble"
''coname(56) = "Kinney"
''coname(57) = "Kleberg"
''coname(58) = "La_Salle"
''coname(59) = "Lavaca"
''coname(60) = "Leon"
''coname(61) = "Liberty"
''coname(62) = "Live_Oak"
''coname(63) = "Loving"
''coname(64) = "Madison"
''coname(65) = "Martin"
''coname(66) = "Matagorda"
''coname(67) = "Maverick"
''coname(68) = "McMullen"
''coname(69) = "Medina"
''coname(70) = "Menard"
''coname(71) = "Midland"
''coname(72) = "Milam"
''coname(73) = "Montgomery"
''coname(74) = "Nacogdoches"
''coname(75) = "Newton"
''coname(76) = "Nueces"
''coname(77) = "Orange"
''coname(78) = "Pecos"
''coname(79) = "Polk"
''coname(80) = "Presidio"
''coname(81) = "Reagan"
''coname(82) = "Real"
''coname(83) = "Reeves"
''coname(84) = "Refugio"
''coname(85) = "Robertson"
''coname(86) = "Runnels"
''coname(87) = "Sabine"
''coname(88) = "San_Augustine"
''coname(89) = "San_Jacinto"
''coname(90) = "San_Patricio"
''coname(91) = "Schleicher"
''coname(92) = "Shelby"
''coname(93) = "Starr"
''coname(94) = "Sterling"
''coname(95) = "Sutton"
''coname(96) = "Terrell"
''coname(97) = "Tom_Green"
''coname(98) = "Trinity"
''coname(99) = "Tyler"
''coname(100) = "Upton"
''coname(101) = "Uvalde"
''coname(102) = "Val_Verde"
''coname(103) = "Victoria"
''coname(104) = "Walker"
''coname(105) = "Waller"
''coname(106) = "Ward"
''coname(107) = "Washington"
''coname(108) = "Webb"
''coname(109) = "Wharton"
''coname(110) = "Willacy"
''coname(111) = "Wilson"
''coname(112) = "Winkler"
''coname(113) = "Zapata"
''coname(114) = "Zavala"

''South County Numbers
''conbr(0) = "002"
''conbr(1) = "003"
''conbr(2) = "004"
''conbr(3) = "007"
''conbr(4) = "008"
''conbr(5) = "010"
''conbr(6) = "013"
''conbr(7) = "015"
''conbr(8) = "020"
''conbr(9) = "021"
''conbr(10) = "022"
''conbr(11) = "024"
''conbr(12) = "026"
''conbr(13) = "029"
''conbr(14) = "031"
''conbr(15) = "036"
''conbr(16) = "041"
''conbr(17) = "045"
''conbr(18) = "046"
''conbr(19) = "048"
''conbr(20) = "052"
''conbr(21) = "053"
''conbr(22) = "055"
''conbr(23) = "062"
''conbr(24) = "064"
''conbr(25) = "067"
''conbr(26) = "069"
''conbr(27) = "070"
''conbr(28) = "072"
''conbr(29) = "076"
''conbr(30) = "080"
''conbr(31) = "082"
''conbr(32) = "083"
''conbr(33) = "085"
''conbr(34) = "088"
''conbr(35) = "089"
''conbr(36) = "090"
''conbr(37) = "094"
''conbr(38) = "095"
''conbr(39) = "101"
''conbr(40) = "102"
''conbr(41) = "109"
''conbr(42) = "114"
''conbr(43) = "116"
''conbr(44) = "119"
''conbr(45) = "121"
''conbr(46) = "122"
''conbr(47) = "123"
''conbr(48) = "124"
''conbr(49) = "125"
''conbr(50) = "126"
''conbr(51) = "129"
''conbr(52) = "131"
''conbr(53) = "066"
''conbr(54) = "133"
''conbr(55) = "134"
''conbr(56) = "136"
''conbr(57) = "137"
''conbr(58) = "142"
''conbr(59) = "143"
''conbr(60) = "145"
''conbr(61) = "146"
''conbr(62) = "149"
''conbr(63) = "151"
''conbr(64) = "154"
''conbr(65) = "156"
''conbr(66) = "158"
''conbr(67) = "159"
''conbr(68) = "162"
''conbr(69) = "163"
''conbr(70) = "164"
''conbr(71) = "165"
''conbr(72) = "166"
''conbr(73) = "170"
''conbr(74) = "174"
''conbr(75) = "176"
''conbr(76) = "178"
''conbr(77) = "181"
''conbr(78) = "186"
''conbr(79) = "187"
''conbr(80) = "189"
''conbr(81) = "192"
''conbr(82) = "193"
''conbr(83) = "195"
''conbr(84) = "196"
''conbr(85) = "198"
''conbr(86) = "200"
''conbr(87) = "202"
''conbr(88) = "203"
''conbr(89) = "204"
''conbr(90) = "205"
''conbr(91) = "207"
''conbr(92) = "210"
''conbr(93) = "214"
''conbr(94) = "216"
''conbr(95) = "218"
''conbr(96) = "222"
''conbr(97) = "226"
''conbr(98) = "228"
''conbr(99) = "229"
''conbr(100) = "231"
''conbr(101) = "232"
''conbr(102) = "233"
''conbr(103) = "235"
''conbr(104) = "236"
''conbr(105) = "237"
''conbr(106) = "238"
''conbr(107) = "239"
''conbr(108) = "240"
''conbr(109) = "241"
''conbr(110) = "245"
''conbr(111) = "247"
''conbr(112) = "248"
''conbr(113) = "253"
''conbr(114) = "254"

'create empty .zip files
'For i = 0 To 138
'    Dim sTextFileName As String
'    Dim fileid As Integer
'    fileid = FreeFile()
'
'    sTextFileName = "T:\DATAMGT\MAPPING\Mapping Products\County Road Update Mapbooks\2009\_Completed Packets\" & UCase(coname(i)) & "_2009.zip"
'    'sTextFileName = "D:\XML\CountyTable.xml"
'    Open sTextFileName For Output As fileid
'    Close fileid
'Next


For i = 0 To 138
  countyname = coname(i)
  countynbr = conbr(i)
  pQueryFilter.WhereClause = "CNTY_NBR = " & "'" & countynbr & "'"

  'set the layer and select features
  Set pLayer = pDoc.FocusMap.layer(0)
  Set pFeatureSelection = pDoc.FocusMap.layer(0)
  pFeatureSelection.SelectFeatures pQueryFilter, esriSelectionResultNew, False
  Call Export
Next
 
MsgBox ("Complete!")
End Sub

Sub Export()
    Dim pDoc As IMxDocument
    Dim pFLayer As IFeatureLayer
    Dim pFc As IFeatureClass
    Dim pINFeatureClassName As IFeatureClassName
    Dim pDataSet As IDataset
    Dim pInDsName As IDatasetName
    Dim pFSel As IFeatureSelection
    Dim pSelSet As ISelectionSet
    Dim pFeatureClassName As IFeatureClassName
    Dim pOutDatasetName As IDatasetName
    Dim pWorkspaceName As IWorkspaceName
    Dim pExportOp As IExportOperation
    Dim pLayer As ILayer
    
    Set pDoc = ThisDocument
    
    Dim LayerName As String
    Set pLayer = pDoc.FocusMap.layer(0)
    LayerName = pDoc.FocusMap.layer(0).Name
    Set pFLayer = pDoc.FocusMap.layer(0)
    Set pFc = pFLayer.featureclass
            
    'Get the Featureclassname from the featureclass
    Set pDataSet = pFc
    Set pINFeatureClassName = pDataSet.FullName
    Set pInDsName = pINFeatureClassName
            
    'Get the selected features
    Set pFSel = pFLayer
    Set pSelSet = pFSel.SelectionSet
            
    'Define the output featureclass
    Set pFeatureClassName = New featureclassname
    Set pOutDatasetName = pFeatureClassName
            
    'CHANGE OUTPUT LAYER NAMES IF NECESSARY
    pOutDatasetName.Name = countyname & "_INVENTORY_2009" 'LayerName
    Set pWorkspaceName = New WorkspaceName
            
    'CHANGE OUTPUT DIRECTORY
    pWorkspaceName.pathName = "T:\DATAMGT\MAPPING\Mapping Products\County Road Update Mapbooks\2009\Inventory Shapefiles"
    pWorkspaceName.WorkspaceFactoryProgID = "esriCore.shapefileworkspacefactory.1"
    Set pOutDatasetName.WorkspaceName = pWorkspaceName
    
    'Give the output shapefile the same props as the input dataset
    pFeatureClassName.FeatureType = pFc.FeatureType
    pFeatureClassName.ShapeType = pFc.ShapeType
    pFeatureClassName.ShapeFieldName = pFc.ShapeFieldName
            
    'Export selected features
    Set pExportOp = New ExportOperation
    pExportOp.ExportFeatureClass pInDsName, Nothing, pSelSet, Nothing, pOutDatasetName, 0
    pFSel.Clear
End Sub


